define(["jquery"],function(a){"use strict";return{defaults:{templates:{url:"/admin/api/pages<% if (!!id) { %>/<%= id %><% } %>?locale=<%= locale %>"},translations:{headline:"app.page"}},header:function(){return{tabs:{url:"/admin/content-navigations?alias=pages",options:{locale:this.options.locale,data:function(){return this.sandbox.util.extend(!1,{},this.data)}.bind(this)},componentOptions:{values:this.data}},toolbar:{buttons:{save:{parent:"saveWithOptions"}},languageChanger:{preSelected:this.options.locale}}}},loadComponentData:function(){var b=a.Deferred();return this.options.id?(this.sandbox.util.load(_.template(this.defaults.templates.url,{id:this.options.id,locale:this.options.locale})).done(function(a){b.resolve(a)}),b):(b.resolve({}),b)},initialize:function(){this.bindCustomEvents()},bindCustomEvents:function(){this.sandbox.on("sulu.header.back",this.toList.bind(this)),this.sandbox.on("sulu.tab.dirty",this.enableSave.bind(this)),this.sandbox.on("sulu.toolbar.save",this.save.bind(this)),this.sandbox.on("sulu.tab.data-changed",this.setData.bind(this)),this.sandbox.on("sulu.header.language-changed",function(a){this.options.id?this.toEdit(this.options.id,a.id):this.toAdd(a.id)}.bind(this))},save:function(a){this.loadingSave(),this.saveTab().then(function(b){this.afterSave(a,b)}.bind(this))},setData:function(a){this.data=a},saveTab:function(){var b=a.Deferred();return this.sandbox.once("sulu.tab.saved",function(a){this.setData(a),b.resolve(a)}.bind(this)),this.sandbox.emit("sulu.tab.save"),b},enableSave:function(){this.sandbox.emit("sulu.header.toolbar.item.enable","save",!1)},loadingSave:function(){this.sandbox.emit("sulu.header.toolbar.item.loading","save")},toList:function(){this.sandbox.emit("sulu.router.navigate","pages/"+this.options.locale)},toEdit:function(a,b){this.sandbox.emit("sulu.router.navigate","pages/"+(b||this.options.locale)+"/edit:"+a+"/details")},toAdd:function(a){this.sandbox.emit("sulu.router.navigate","pages/"+(a||this.options.locale)+"/add")},afterSave:function(a,b){this.sandbox.emit("sulu.header.toolbar.item.disable","save",!0),this.sandbox.emit("sulu.header.saved",b),"back"===a?this.toList():"new"===a?this.toAdd():this.options.id||(this.toEdit(b.id),this.sandbox.emit("sulu.router.navigate","pages/edit:"+b.id+"/details"))}}});